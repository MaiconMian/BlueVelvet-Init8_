<html>
    <head>
        <title>BlueVelvet Music Store</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <link rel="stylesheet" href="../assets/css/styles.css">
        <link rel="stylesheet" href="https://cdn.datatables.net/2.1.8/css/dataTables.dataTables.css" />
        <link rel="stylesheet" href="../assets/font-awesome/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://cdn.datatables.net/2.1.8/css/dataTables.dataTables.min.css" />

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.css">
        <link rel="stylesheet" href="https://cdn.datatables.net/2.1.8/css/dataTables.bootstrap4.css">
        
    </head>
    <header>
        
    </header>
    <body class="d-flex flex-column min-vh-100">
        <div>
            <nav class="navbar navbar-expand-lg navbar-light bg-light nav-justified">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor02" aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            
                <div class="collapse navbar-collapse" id="navbarColor02">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item d-flex align-items-center">
                            <img src="../assets/images/logoBVMS.png" />
                        </li>
                        <li class="nav-item d-flex align-items-center active">
                            <a class="nav-link" href="#">Articles <span class="sr-only">(current)</span></a>
                        </li>
                        <li class="nav-item d-flex align-items-center">
                            <a class="nav-link" href="#">Brands</a>
                        </li>
                        <li class="nav-item d-flex align-items-center">
                            <a class="nav-link" href="#">Categories</a>
                        </li>
                        <li class="nav-item d-flex align-items-center">
                            <a class="nav-link" href="#">Customers</a>
                        </li>
                        <li class="nav-item d-flex align-items-center">
                            <a class="nav-link" href="#">Menus</a>
                        </li>
                        <li class="nav-item d-flex align-items-center">
                            <a class="nav-link" href="#">Orders</a>
                        </li>
                        <li class="nav-item d-flex align-items-center">
                            <a class="nav-link" href="#">Products</a>
                        </li>
                        <li class="nav-item d-flex align-items-center">
                            <a class="nav-link" href="#">Sales</a>
                        </li>
                        <li class="nav-item d-flex align-items-center">
                            <a class="nav-link" href="#">Report</a>
                        </li>
                        <li class="nav-item d-flex align-items-center">
                            <a class="nav-link" href="#">Settings</a>
                        </li>
                        <li class="nav-item d-flex align-items-center">
                            <a class="nav-link" href="#">Shipping</a>
                        </li>
                        <li class="nav-item d-flex align-items-center">
                            <a class="nav-link" href="#">Users</a>
                        </li>
                    </ul>
                </div>
            </nav>
            
        </div>
        <div class="d-flex flex-column">
            <div class="p-2"><h3>BlueVelvet Admin Control Panel</h3></div>
        </div>
         <div class="container">
        <h1>BlueVelvet Music Store</h1>
        <h2>Product Management</h2>

        
        <table id="products" class="table table-striped table-bordered display" style="width:100%;">
            <div class="panel-heading"><a role="button" data-toggle="modal" data-target="#modalCreate" class="pull-right" ><i class="fa fa-plus"></i>  New Product</a></div>

            <thead>
                <tr>
                    <th>ID</th>
                    <th>Image</th>
                    <th>Name</th>
                    <th>Brand</th>
                    <th>Category</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                
            </tbody>
        </table>
        

        
    </div>
    <div class="modal fade" id="modalEdit">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-header">
                    <h4 class="modal-title">Edit Product</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group col-sm-12">
                        <label for="name">Product Name</label>
                        <input type="text" class="form-control input-lg" id="name" name="name" placeholder="Product Name" required />
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="shortDescription">Short Description</label>
                        <textarea class="form-control input-lg" id="shortDescription" name="shortDescription" placeholder="Short Description" required></textarea>
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="fullDescription">Full Description</label>
                        <textarea class="form-control input-lg" id="fullDescription" name="fullDescription" placeholder="Full Description" required></textarea>
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="brand">Brand</label>
                        <select id="brands" name="brand" class="form-control">
                         
                        </select>                   
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="category">Category</label>
                        <select id="categories" name="category" class="form-control">
                            
                        </select> 
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="mainImage">Choose main image</label>
                        <input type="file" class="form-control input-lg" id="mainImage" name="mainImage" accept="image/png" required />
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="featuredImages">Choose featured images</label>
                        <input type="file" class="form-control input-lg" id="featuredImages" name="featuredImages" accept="image/png" multiple />
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="listPrice">List Price</label>
                        <input type="number" class="form-control input-lg" id="listPrice" name="listPrice" placeholder="List Price" step="0.01" required />
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="discountPercent">Discount Percent</label>
                        <input type="number" class="form-control input-lg" id="discountPercent" name="discountPercent" placeholder="Discount Percent" min="0" max="100" required />
                    </div>

                    <div class="form-group col-sm-6">
                        <label for="enabled">
                            <input type="checkbox" id="enabled" name="enabled"> Enabled
                        </label>
                    </div>

                    <div class="form-group col-sm-6">
                        <label for="inStock">
                            <input type="checkbox" id="inStock" name="inStock"> In Stock
                        </label>
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="length">Length (inches)</label>
                        <input type="number" class="form-control input-lg" id="length" name="length" placeholder="Length (inches)" step="0.01" required />
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="width">Width (inches)</label>
                        <input type="number" class="form-control input-lg" id="width" name="width" placeholder="Width (inches)" step="0.01" required />
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="height">Height (inches)</label>
                        <input type="number" class="form-control input-lg" id="height" name="height" placeholder="Height (inches)" step="0.01" required />
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="weight">Weight (pounds)</label>
                        <input type="number" class="form-control input-lg" id="weight" name="weight" placeholder="Weight (pounds)" step="0.01" required />
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="cost">Cost</label>
                        <input type="number" class="form-control input-lg" id="cost" name="cost" placeholder="Cost" step="0.01" required />
                    </div>

                    <div id="productDetails" class="form-group col-sm-12">
                        <label>Product Details</label>
                        <input type="text" class="form-control input-lg" name="detailName" placeholder="Detail Name" />
                        <br/>
                        <input type="text" class="form-control input-lg" name="detailValue" placeholder="Detail Value" />
                        <br />
                        <button type="button" class="btn btn-secondary btn-sm" id="addDetailBtn">Add Detail</button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" onclick="document.querySelector('#formEdit').reset()" data-dismiss="modal">Close</button>
                    <button type="submit" id="submitEditButton" class="btn btn-primary disabled-on-loading"> Update</button>
                </div>
                </form>
            </div>
        </div>
    </div>
    <div class="modal fade" id="modalDelete">
        <div class="modal-dialog">
            <div class="modal-content">
                <form id="formDelete" onsubmit="document.getElementById('submitDeleteButton').setAttribute('disabled','')">

                <div class="modal-header">
                    <h4 class="modal-title">Delete Product</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                        <div class="card-body">
                            Are you sure you want to delete this product?
                        </div>

                        <br />

                        <label> Yes</label>
                        <input type="checkbox" required="" name="yes" value="1"  />

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default"  data-dismiss="modal">Close</button>
                        <button type="submit" id="submitDeleteButton" class="btn btn-danger">Delete</button>
                    </form>
                </div>
                </form>
            </div>
    </div>
    
        
    </div>
    <div class="modal fade" id="modalCreate">
        <div class="modal-dialog">
            <div class="modal-content">
                <form action="" id="formCreateProduct">
                <div class="modal-header">
                    <h4 class="modal-title">New Product</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group col-sm-12">
                        <label for="name">Product Name</label>
                        <input type="text" class="form-control input-lg" id="name" name="name" placeholder="Product Name" required />
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="shortDescription">Short Description</label>
                        <textarea class="form-control input-lg" id="shortDescription" name="shortDescription" placeholder="Short Description" required></textarea>
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="fullDescription">Full Description</label>
                        <textarea class="form-control input-lg" id="fullDescription" name="fullDescription" placeholder="Full Description" required></textarea>
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="brand">Brand</label>
                        <select id="brands" required name="brand" class="form-control">
                         
                        </select>                   
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="category">Category</label>
                        <select id="categories" required name="category" class="form-control">
                            
                        </select> 
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="mainImage">Choose main image</label>
                        <input type="file" class="form-control input-lg" id="mainImage" name="mainImage" accept="image/png" required />
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="featuredImages">Choose featured images</label>
                        <input type="file" class="form-control input-lg" id="featuredImages" name="featuredImages" accept="image/png" multiple />
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="listPrice">List Price</label>
                        <input type="number" class="form-control input-lg" id="listPrice" name="listPrice" placeholder="List Price" step="0.01" required />
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="discountPercent">Discount Percent</label>
                        <input type="number" class="form-control input-lg" id="discountPercent" name="discountPercent" placeholder="Discount Percent" min="0" max="100" required />
                    </div>

                    <div class="form-group col-sm-6">
                        <label for="enabled">
                            <input type="checkbox" id="enabled" name="enabled"> Enabled
                        </label>
                    </div>

                    <div class="form-group col-sm-6">
                        <label for="inStock">
                            <input type="checkbox" id="inStock" name="inStock"> In Stock
                        </label>
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="length">Length (inches)</label>
                        <input type="number" class="form-control input-lg" id="length" name="length" placeholder="Length (inches)" step="0.01" required />
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="width">Width (inches)</label>
                        <input type="number" class="form-control input-lg" id="width" name="width" placeholder="Width (inches)" step="0.01" required />
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="height">Height (inches)</label>
                        <input type="number" class="form-control input-lg" id="height" name="height" placeholder="Height (inches)" step="0.01" required />
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="weight">Weight (pounds)</label>
                        <input type="number" class="form-control input-lg" id="weight" name="weight" placeholder="Weight (pounds)" step="0.01" required />
                    </div>

                    <div class="form-group col-sm-12">
                        <label for="cost">Cost</label>
                        <input type="number" class="form-control input-lg" id="cost" name="cost" placeholder="Cost" step="0.01" required />
                    </div>

                    <div id="productDetails" class="form-group col-sm-12">
                        <label>Product Details</label>
                        <input type="text" class="form-control input-lg" name="detailName" placeholder="Detail Name" />
                        <br/>
                        <input type="text" class="form-control input-lg" name="detailValue" placeholder="Detail Value" />
                        <br />
                        <button type="button" class="btn btn-secondary btn-sm" id="addDetailBtn">Add Detail</button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" onclick="document.querySelector('#formEdit').reset()" data-dismiss="modal">Close</button>
                    <button type="submit" id="submitEditButton" class="btn btn-primary disabled-on-loading"> Update</button>
                </div>
                </form>
            </div>
        </div>
    </div>    
       
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>

        <script src="https://cdn.datatables.net/2.1.8/js/dataTables.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <script src="https://cdn.datatables.net/2.1.8/js/dataTables.js"></script>
        <script src="https://cdn.datatables.net/2.1.8/js/dataTables.bootstrap4.js"></script>



        <script>

            $.ajax({
                url: 'http://localhost:8090/api/v1/products',
                type: 'GET',
                success: function(response) {
                    //listProducts(response.data);
                    
                    const productsData = response.data;
                    const data = productsData.map(p=>({
                        id: p.id,
                        image: p.image,
                        name: p.name,
                        brand: p.brand,
                        category: "a",
                        actions: ` <button type="button" id="btnShow" class="btn btn-primary"><i class="fa fa-eye" aria-hidden="true"></i></button>
                            <button type="button" data-toggle="modal" data-target="#modalEdit" id="btnEdit" class="btn btn-success" data-id=""><i class="fa fa-pencil-square-o" aria-hidden="true"></i></button>
                            <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#modalDelete" id="btnDelete" data-id=""><i class="fa fa-trash" aria-hidden="true"></i></button>`  
                    })); 
                    //const data = [{id: 1, image:"a", name:"a", brand:"a",category:"a",actions:"a"}]; 
                    new DataTable('#products',{
                    data:data,
                    columns: [
                            { data: "id", title: "ID"},
                            { data: "image" , title:"Image"},
                            { data: "name" , title:"Name"},
                            { data: "brand" , title:"Brand"},
                            { data: "category" , title:"Category"},
                            { data: "actions", title: "Actions"}
                    ]
                });
                const divElement = document.querySelector('div.dt-paging');

                if (divElement) {
                    divElement.classList.remove('dt-paging');
                }
                },
                error: function(xhr, status, error) {
                    console.error("Error on requisition:", status, error);
                }
            });

            $.ajax({
                url: 'http://localhost:8090/api/v1/brands',
                type: 'GET',
                success: function(response) {
                    const data = response.data;
                    let brandsFields = document.querySelectorAll('#brands');

                    Object.keys(data).forEach((key)=>{
                        
                        brandsFields[0].innerHTML += `<option value="${data[key].id}">${data[key].brandName}</option>`;
                        brandsFields[1].innerHTML += `<option value="${data[key].id}">${data[key].brandName}</option>`;

                    });
                },
                error: function(xhr, status, error) {
                    console.error("Error on requisition:", status, error);
                }
            });
            $.ajax({
                url: 'http://localhost:8090/api/v1/categories',
                type: 'GET',
                success: function(response) {
                    //console.log(response.data);
                    const data = response.data;
                    let categoriesFields = document.querySelectorAll('#categories');
                    Object.keys(data).forEach((key)=>{
                        
                        categoriesFields[0].innerHTML += `<option value="${data[key].id}">${data[key].categoryName}</option>`;
                        categoriesFields[1].innerHTML += `<option value="${data[key].id}">${data[key].categoryName}</option>`;

                    });
                },
                error: function(xhr, status, error) {
                    console.error("Error on requisition:", status, error);
                }
            });
            document.querySelector("#formCreateProduct").addEventListener('submit', (e)=>{
                e.preventDefault();
                console.log('oi');

                var formData = {
                    name: $("#name").val(),
                    shortDescription: $("#shortDescription").val(),
                    fullDescription: $("#fullDescription").val(),
                    brand: $("#brands").val(),
                    category: $("#categories").val(),
                    mainImage: $("#mainImage")[0].files[0], // file input
                    featuredImages: $("#featuredImages")[0].files, // multiple file input
                    listPrice: $("#listPrice").val(),
                    discountPercent: $("#discountPercent").val(),
                    enabled: $("#enabled").is(":checked"),
                    inStock: $("#inStock").is(":checked"),
                    length: $("#length").val(),
                    width: $("#width").val(),
                    height: $("#height").val(),
                    weight: $("#weight").val(),
                    cost: $("#cost").val(),
                    detailName: $("input[name='detailName']").map(function() { return $(this).val(); }).get(),
                    detailValue: $("input[name='detailValue']").map(function() { return $(this).val(); }).get()
                };


                $.ajax({
                    url: 'http:localhost:8090/api/v1/addproduct',
                    type: 'POST',
                    data: formData,
                    success: function(response){
                        console.log(response);
                    },
                    error: function(xhr, status, error) {
                        console.error("Error on requisition:", status, error);
                    } 
                });
            });
        </script>
    </body>
    <footer style="background-color:#f8f9fa" class="mt-auto">
        <div class="p-2"><h6>BlueVelvet Admin Control Panel - Copyright &copy; BlueVelvet</h6></div>
    </footer>
</html>
